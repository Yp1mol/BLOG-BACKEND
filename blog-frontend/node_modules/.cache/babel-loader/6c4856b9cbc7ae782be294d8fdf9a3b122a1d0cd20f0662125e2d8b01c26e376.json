{"ast":null,"code":"var _jsxFileName = \"/home/yegor/blog-backend/blog-frontend/src/contexts/PostsContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useReducer, useEffect } from \"react\";\nimport { fetchPosts, createPost, deletePostupdatePost } from \"../api\";\nimport { useAuth } from \"./AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PostsContext = /*#__PURE__*/createContext(null);\nexport const usePosts = () => {\n  _s();\n  return useContext(PostsContext);\n};\n_s(usePosts, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nfunction postsReducer(state, action) {\n  switch (action.type) {\n    case \"SET_POSTS\":\n      return action.payload;\n    case \"ADD_POST\":\n      return [...state, action.payload];\n    case \"DELETE_POST\":\n      return state.filter(p => p.id !== action.payload);\n    default:\n      return state;\n  }\n}\nexport const PostsProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    token\n  } = useAuth();\n  const [posts, dispatch] = useReducer(postsReducer, []);\n  useEffect(() => {\n    if (!token) {\n      dispatch({\n        type: \"SET_POSTS\",\n        payload: []\n      });\n      return;\n    }\n    const load = async () => {\n      const data = await fetchPosts(token);\n      dispatch({\n        type: \"SET_POSTS\",\n        payload: data\n      });\n    };\n    load();\n  }, [token]);\n  const addPost = async postData => {\n    console.log(\"TOKEN:\", token);\n    const newPost = await createPost(token, postData);\n    dispatch({\n      type: \"ADD_POST\",\n      payload: newPost\n    });\n  };\n  const removePost = async id => {\n    await deletePost(token, id);\n    dispatch({\n      type: \"DELETE_POST\",\n      payload: id\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(PostsContext.Provider, {\n    value: {\n      posts,\n      createPost: addPost,\n      removePost\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n};\n_s2(PostsProvider, \"pChjyPTVWCePaeApWVtG41Qgfd0=\", false, function () {\n  return [useAuth];\n});\n_c = PostsProvider;\nvar _c;\n$RefreshReg$(_c, \"PostsProvider\");","map":{"version":3,"names":["createContext","useContext","useReducer","useEffect","fetchPosts","createPost","deletePostupdatePost","useAuth","jsxDEV","_jsxDEV","PostsContext","usePosts","_s","postsReducer","state","action","type","payload","filter","p","id","PostsProvider","children","_s2","token","posts","dispatch","load","data","addPost","postData","console","log","newPost","removePost","deletePost","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/yegor/blog-backend/blog-frontend/src/contexts/PostsContext.js"],"sourcesContent":["import { createContext, useContext, useReducer, useEffect } from \"react\";\nimport { fetchPosts, createPost, deletePostupdatePost  } from \"../api\";\nimport { useAuth } from \"./AuthContext\";\n\nconst PostsContext = createContext(null);\nexport const usePosts = () => useContext(PostsContext);\n\nfunction postsReducer(state, action) {\n  switch (action.type) {\n    case \"SET_POSTS\":\n      return action.payload;\n\n    case \"ADD_POST\":\n      return [...state, action.payload];\n\n    case \"DELETE_POST\":\n      return state.filter((p) => p.id !== action.payload);\n\n    default:\n      return state;\n  }\n}\n\nexport const PostsProvider = ({ children }) => {\n  const { token } = useAuth();\n  const [posts, dispatch] = useReducer(postsReducer, []);\n\n  useEffect(() => {\n    if (!token) {\n      dispatch({ type: \"SET_POSTS\", payload: [] });\n      return;\n    }\n\n    const load = async () => {\n      const data = await fetchPosts(token);\n      dispatch({ type: \"SET_POSTS\", payload: data });\n    };\n\n    load();\n  }, [token]);\n\n  const addPost = async (postData) => {\n    console.log(\"TOKEN:\", token);\n    const newPost = await createPost(token, postData);\n    dispatch({ type: \"ADD_POST\", payload: newPost });\n  };\n\n  const removePost = async (id) => {\n    await deletePost(token, id);\n    dispatch({ type: \"DELETE_POST\", payload: id });\n  };\n\n  return (\n    <PostsContext.Provider value={{ posts, createPost: addPost, removePost }}>\n      {children}\n    </PostsContext.Provider>\n  );\n};\n"],"mappings":";;;AAAA,SAASA,aAAa,EAAEC,UAAU,EAAEC,UAAU,EAAEC,SAAS,QAAQ,OAAO;AACxE,SAASC,UAAU,EAAEC,UAAU,EAAEC,oBAAoB,QAAS,QAAQ;AACtE,SAASC,OAAO,QAAQ,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,YAAY,gBAAGV,aAAa,CAAC,IAAI,CAAC;AACxC,OAAO,MAAMW,QAAQ,GAAGA,CAAA;EAAAC,EAAA;EAAA,OAAMX,UAAU,CAACS,YAAY,CAAC;AAAA;AAACE,EAAA,CAA1CD,QAAQ;AAErB,SAASE,YAAYA,CAACC,KAAK,EAAEC,MAAM,EAAE;EACnC,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,WAAW;MACd,OAAOD,MAAM,CAACE,OAAO;IAEvB,KAAK,UAAU;MACb,OAAO,CAAC,GAAGH,KAAK,EAAEC,MAAM,CAACE,OAAO,CAAC;IAEnC,KAAK,aAAa;MAChB,OAAOH,KAAK,CAACI,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACC,EAAE,KAAKL,MAAM,CAACE,OAAO,CAAC;IAErD;MACE,OAAOH,KAAK;EAChB;AACF;AAEA,OAAO,MAAMO,aAAa,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,GAAA;EAC7C,MAAM;IAAEC;EAAM,CAAC,GAAGjB,OAAO,CAAC,CAAC;EAC3B,MAAM,CAACkB,KAAK,EAAEC,QAAQ,CAAC,GAAGxB,UAAU,CAACW,YAAY,EAAE,EAAE,CAAC;EAEtDV,SAAS,CAAC,MAAM;IACd,IAAI,CAACqB,KAAK,EAAE;MACVE,QAAQ,CAAC;QAAEV,IAAI,EAAE,WAAW;QAAEC,OAAO,EAAE;MAAG,CAAC,CAAC;MAC5C;IACF;IAEA,MAAMU,IAAI,GAAG,MAAAA,CAAA,KAAY;MACvB,MAAMC,IAAI,GAAG,MAAMxB,UAAU,CAACoB,KAAK,CAAC;MACpCE,QAAQ,CAAC;QAAEV,IAAI,EAAE,WAAW;QAAEC,OAAO,EAAEW;MAAK,CAAC,CAAC;IAChD,CAAC;IAEDD,IAAI,CAAC,CAAC;EACR,CAAC,EAAE,CAACH,KAAK,CAAC,CAAC;EAEX,MAAMK,OAAO,GAAG,MAAOC,QAAQ,IAAK;IAClCC,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAER,KAAK,CAAC;IAC5B,MAAMS,OAAO,GAAG,MAAM5B,UAAU,CAACmB,KAAK,EAAEM,QAAQ,CAAC;IACjDJ,QAAQ,CAAC;MAAEV,IAAI,EAAE,UAAU;MAAEC,OAAO,EAAEgB;IAAQ,CAAC,CAAC;EAClD,CAAC;EAED,MAAMC,UAAU,GAAG,MAAOd,EAAE,IAAK;IAC/B,MAAMe,UAAU,CAACX,KAAK,EAAEJ,EAAE,CAAC;IAC3BM,QAAQ,CAAC;MAAEV,IAAI,EAAE,aAAa;MAAEC,OAAO,EAAEG;IAAG,CAAC,CAAC;EAChD,CAAC;EAED,oBACEX,OAAA,CAACC,YAAY,CAAC0B,QAAQ;IAACC,KAAK,EAAE;MAAEZ,KAAK;MAAEpB,UAAU,EAAEwB,OAAO;MAAEK;IAAW,CAAE;IAAAZ,QAAA,EACtEA;EAAQ;IAAAgB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACY,CAAC;AAE5B,CAAC;AAAClB,GAAA,CAlCWF,aAAa;EAAA,QACNd,OAAO;AAAA;AAAAmC,EAAA,GADdrB,aAAa;AAAA,IAAAqB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}