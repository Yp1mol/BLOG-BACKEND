{"ast":null,"code":"var _jsxFileName = \"/home/yegor/blog-backend/blog-frontend/src/contexts/PostsContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useReducer, useEffect } from \"react\";\nimport { fetchPosts, createPost, deletePost, updatePost } from \"../api\";\nimport { useAuth } from \"./AuthContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PostsContext = /*#__PURE__*/createContext(null);\nexport const usePosts = () => {\n  _s();\n  return useContext(PostsContext);\n};\n_s(usePosts, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nfunction postsReducer(state, action) {\n  switch (action.type) {\n    case \"SET_POSTS\":\n      return action.payload;\n    case \"ADD_POST\":\n      return [...state, action.payload];\n    case \"UPDATE_POST\":\n      return state.map(p => p.id === action.payload.id ? action.payload : p);\n    case \"DELETE_POST\":\n      return state.filter(p => p.id !== action.payload);\n    default:\n      return state;\n  }\n}\nexport const PostsProvider = ({\n  children\n}) => {\n  _s2();\n  const {\n    token\n  } = useAuth();\n  const [posts, dispatch] = useReducer(postsReducer, []);\n  useEffect(() => {\n    if (!token) {\n      dispatch({\n        type: \"SET_POSTS\",\n        payload: []\n      });\n      return;\n    }\n    const load = async () => {\n      const data = await fetchPosts(token);\n      dispatch({\n        type: \"SET_POSTS\",\n        payload: data\n      });\n    };\n    load();\n  }, [token]);\n  const addPost = async postData => {\n    try {\n      const newPost = await createPost(token, postData);\n      dispatch({\n        type: \"ADD_POST\",\n        payload: newPost\n      });\n    } catch (error) {\n      console.error(\"Validation Error:\", error.message);\n      throw error;\n    }\n  };\n  const editPost = async (id, data) => {\n    const updated = await updatePost(token, id, data);\n    dispatch({\n      type: \"UPDATE_POST\",\n      payload: updated\n    });\n  };\n  const removePost = async id => {\n    await deletePost(token, id);\n    dispatch({\n      type: \"DELETE_POST\",\n      payload: id\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(PostsContext.Provider, {\n    value: {\n      posts,\n      createPost: addPost,\n      removePost,\n      updatePost: editPost\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n};\n_s2(PostsProvider, \"pChjyPTVWCePaeApWVtG41Qgfd0=\", false, function () {\n  return [useAuth];\n});\n_c = PostsProvider;\nvar _c;\n$RefreshReg$(_c, \"PostsProvider\");","map":{"version":3,"names":["createContext","useContext","useReducer","useEffect","fetchPosts","createPost","deletePost","updatePost","useAuth","jsxDEV","_jsxDEV","PostsContext","usePosts","_s","postsReducer","state","action","type","payload","map","p","id","filter","PostsProvider","children","_s2","token","posts","dispatch","load","data","addPost","postData","newPost","error","console","message","editPost","updated","removePost","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/yegor/blog-backend/blog-frontend/src/contexts/PostsContext.js"],"sourcesContent":["import { createContext, useContext, useReducer, useEffect } from \"react\";\nimport { fetchPosts, createPost, deletePost, updatePost } from \"../api\";\nimport { useAuth } from \"./AuthContext\";\n\nconst PostsContext = createContext(null);\nexport const usePosts = () => useContext(PostsContext);\n\nfunction postsReducer(state, action) {\n  switch (action.type) {\n    case \"SET_POSTS\":\n      return action.payload;\n\n    case \"ADD_POST\":\n      return [...state, action.payload];\n\n    case \"UPDATE_POST\":\n      return state.map(p =>\n        p.id === action.payload.id ? action.payload : p\n      );\n\n    case \"DELETE_POST\":\n      return state.filter((p) => p.id !== action.payload);\n\n    default:\n      return state;\n  }\n}\n\nexport const PostsProvider = ({ children }) => {\n  const { token } = useAuth();\n  const [posts, dispatch] = useReducer(postsReducer, []);\n\n  useEffect(() => {\n    if (!token) {\n      dispatch({ type: \"SET_POSTS\", payload: [] });\n      \n      return;\n    }\n\n    const load = async () => {\n      const data = await fetchPosts(token);\n      dispatch({ type: \"SET_POSTS\", payload: data });\n    };\n\n    load();\n  }, [token]);\n  const addPost = async (postData) => {\n    try {\n      const newPost = await createPost(token, postData);\n      dispatch({ type: \"ADD_POST\", payload: newPost });\n    } catch (error) {\n      console.error(\"Validation Error:\", error.message);\n      throw error; \n    }\n  };\n\n  const editPost = async (id, data) => {\n    const updated = await updatePost(token, id, data);\n    dispatch({ type: \"UPDATE_POST\", payload: updated });\n  };\n\n\n  const removePost = async (id) => {\n    await deletePost(token, id);\n    dispatch({ type: \"DELETE_POST\", payload: id });\n  };\n\n  return (\n    <PostsContext.Provider value={{ posts, createPost: addPost, removePost, updatePost: editPost }}>\n      {children}\n    </PostsContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}